* Autogenerated by the Creatures Map Editor
* For more info see http://cdn.creatures.net

* And edited by DementChild
* Bla bla bla http://freewebs.com/dementopia (down)

* --11/03/2022--
* And edited again by NeoDement (DementChild)
* Bla bla bla https://neodem.net/Creatures



*check if the fav place and fireplace exist. if they do the room is probably already installed!
doif totl 1 3 64707 < 100 and totl 1 1 64700 < 100

*This checks to see if the map is big enough - if it isn't, make it bigger
*(snippet from Liam's CCSF 2006 "Creating a Metaroom" tutorial)
	doif maph < 100000
		mapd mapw 100000
	endi
	doif mapw < 100000
		mapd 100000 maph
	endi

* Addon file: deletes existing metarooms at the same place, same background name
* 1 metarooms, 6 rooms, 6 doors


	setv va00 gmap 512 99436
	doif va00 <> -1
* check it is made from the same background
		doif bkds va00 <> "XmasRoom1"
			outs "background"
			stop
		endi

		enum 1 1 229
			kill targ
		next

		enum 0 0 0
			setv va32 attr
			andv va32 32
			doif va32 ne 32
				doif targ ne pntr
					doif gmap posx posy = va00 and carr = null
*edited to move agents still in the room to the Capillata Hub instead of throwing an error
*	cmrt 0



						mvsf 2628 9023

*apply some velocity to objects that have been moved to the Capillata Hub.
*don't do this if they're objects without Suffer Collisions and Suffer Physics or they will fly away, never to be seen again.

						setv va50 attr
						andv va50 128

						setv va51 attr
						andv va51 64

						doif va50 = 128 and va51 = 64

							velo rand -20 20 15
						endi


*	seta va33 targ
*	new: comp 1 1 229 "blank" 1 0 9000
*	attr 32
*	frel va33
*	pat: fixd 1 "blank" 0 0 0 0 "whiteontransparentchars"
*	flto 0 30
*	part 1
*	ptxt "Please take out the agents first!"
*	outs "agent"
*	stop
					endi
				endi
			endi
		next

		sets va01 erid va00

		doif strl va01 > 0
			setv va03 1
			sets va98 ""
			loop
				setv va99 char va01 va03
				doif va99 = ' '
					doif va98 <> ""
						delr stoi va98
						sets va98 ""
					endi
				else
					sets va50 " "
					char va50 1 va99
					adds va98 va50
				endi
				addv va03 1
			untl va03 > strl va01
			doif va98 <> ""
				delr stoi va98
				sets va98 ""
			endi
		endi


		delm va00

	endi

	setv game "mapeditortmp" addm 0 99052 1024 768 "XmasRoom1"
	mmsc 512 99436 ""
	setv va00 addr game "mapeditortmp" 655 675 99513 99513 99810 99810
	rtyp va00 0
	rmsc 665 99661 ""
	setv game "mapeditortmp_0" va00
	setv va00 addr game "mapeditortmp" 326 348 99514 99513 99812 99812
	rtyp va00 0
	rmsc 337 99663 ""
	setv game "mapeditortmp_1" va00
	setv va00 addr game "mapeditortmp" 0 1023 99052 99052 99503 99503
	rtyp va00 0
	rmsc 511 99277 ""
	setv game "mapeditortmp_2" va00
	setv va00 addr game "mapeditortmp" 675 1023 99503 99503 99810 99810
	rtyp va00 0
	rmsc 849 99656 ""
	setv game "mapeditortmp_3" va00
	setv va00 addr game "mapeditortmp" 0 326 99503 99503 99812 99812
	rtyp va00 0
	rmsc 163 99657 ""
	setv game "mapeditortmp_4" va00
	setv va00 addr game "mapeditortmp" 348 655 99513 99513 99812 99810
	rtyp va00 0
	rmsc 501 99661 ""
	setv game "mapeditortmp_5" va00

	door game "mapeditortmp_0" game "mapeditortmp_3" 100
	door game "mapeditortmp_0" game "mapeditortmp_5" 100
	door game "mapeditortmp_1" game "mapeditortmp_4" 100
	door game "mapeditortmp_1" game "mapeditortmp_5" 100
	door game "mapeditortmp_2" game "mapeditortmp_3" 100
	door game "mapeditortmp_2" game "mapeditortmp_4" 100

	delg "mapeditortmp_0"
	delg "mapeditortmp_1"
	delg "mapeditortmp_2"
	delg "mapeditortmp_3"
	delg "mapeditortmp_4"
	delg "mapeditortmp_5"
	new: simp 1 3 64707 "fav_place_xmas" 1 0 1
	attr 272
*	mvto 478 99333
	mvto 909 99757
	tick 10
*associate the norn meso music with the metaroom (the default sounds too depressing)
	mmsc 501 99503 "ds_music.mng\\StringsFull"
*	cmrp 501 99503 0
	cmrp 909 99757 0




* RED PRESENT (STACKABLE BLOCKS) INSTALL SCRIPT

	inst
* Genus Toy, Plane 5000
	new: simp 2 21 64704 "przy" 2 4 5000

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1


* Nestled safely under our tree
	mvto 809 99668



* BLUE PRESENT (DALEK) INSTALL SCRIPT

	inst
* Genus Toy, Plane 4999
	new: simp 2 21 64708 "przy" 2 0 4999

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

* Nestled safely under our tree
	mvto 839 99678



* PURPLE PRESENT (FURBY) INSTALL SCRIPT

	inst
* Genus Toy, Plane 5000
	new: simp 2 21 64705 "przy" 2 1 5000

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

* Nestled safely under our tree
	mvto 809 99668



* PINK PRESENT (RC CAR) INSTALL SCRIPT

	inst
* Genus Toy, Plane 8001
	new: simp 2 21 64712 "przy" 2 3 8001

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

* Nestled safely under our tree
	mvto 879 99678



* SANTA HAT INSTALL SCRIPT

	inst
* Genus Invisible, Plane 10
	new: simp 1 1 64706 "przy" 1 2 10

*Mouseable + Activateable
	attr 6

	mvto 617 99501



* COAT HANGER INSTALL SCRIPT

	inst
* Genus Invisible, Plane 10
	new: simp 1 1 64713 "coathanger" 4 0 10

*Mouseable + Activateable
	attr 6
	tran 0 0

	mvto 507 99491



* MINCE PIE VENDOR INSTALL SCRIPT

	inst
* Genus Vendor, Plane 400
	new: comp 2 23 64722 "mvnd" 0 0 400
	prt: inew 0 "input" "Mince Pie Vendor input" 94 118 1000
	prt: onew 0 "output" "Mince Pie Vendor output" 76 118

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit
	bhvr 11

	perm 100
	elas 0
	accg 10
	aero 10
	fric 100

	mvto 100 99595



* XMAS PUDDING VENDOR INSTALL SCRIPT

	inst
* Genus Vendor, Plane 400
	new: comp 2 23 64726 "pudv" 0 0 400
	prt: inew 0 "input" "Pudding Vendor input" 19 50 1000
	prt: onew 0 "output" "Pudding Vendor output" 19 65

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit
	bhvr 11

	perm 100
	elas 0
	accg 10
	aero 10
	fric 100

	mvto 1 99595

	core 0 108 9 154
*	dcor 1

* TURKEY-O-MATIC VENDOR INSTALL SCRIPT

	inst
* Genus Vendor, Plane 400
	new: comp 2 23 64724 "tomc" 0 0 400
	prt: inew 0 "input" "Turkey-O-Matic input" 143 62 1000
	prt: onew 0 "output" "Turkey-O-Matic output" 143 78

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + Activate 2 + Hit
	bhvr 11

	perm 100
	elas 0
	accg 10
	aero 10
	fric 100

	mvto 50 99595



* RED STOCKING (HAPPY BALL) INSTALL SCRIPT

	inst
* Genus Toy, Plane 450
	new: simp 2 21 64714 "stok" 4 0 450

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

*Carryable + Mouseable + Activateable + Invisible
	attr 23

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	mvto 357 99503



* GREEN STOCKING (MINI SPINNING TOP) INSTALL SCRIPT

	inst
* Genus Toy, Plane 450
	new: simp 2 21 64715 "stok" 4 1 450

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

*Carryable + Mouseable + Activateable + Invisible
	attr 23

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	mvto 407 99500



*BLUE STOCKING (SNOW GLOBE) INSTALL SCRIPT

	inst
* Genus Toy, Plane 450
	new: simp 2 21 64716 "stok" 4 2 450

	perm 60
	elas 0
	fric 100
	accg 3
	aero 1

*Carryable + Mouseable + Activateable + Invisible
	attr 23

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	mvto 457 99504



* XMAS TELEPORTERS INSTALL SCRIPT

	inst
* Genus Teleporter, Plane 5000
* starts on image 38 (dummy sprite used for collision, not using CORE because it puts the help speech bubble too high up)
	new: comp 3 2 64720 "xstp" 0 38 5000
	pat: dull 1 "xstp" 0 -54 -152 1

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + 2
	bhvr 3

	perm 100
	accg 3
	fric 70
	aero 1
	elas 10

*in the xmas room
	mvto 200 99579

	seta va00 targ

* Genus Teleporter, Plane 5000
* starts on image 38 (dummy sprite used for collision, not using CORE because it puts the help speech bubble too high up)
	new: comp 3 2 64720 "xstp" 0 38 5000
	pat: dull 1 "xstp" 0 -54 -152 1

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

*Activate 1 + 2
	bhvr 3

	perm 100
	accg 3
	fric 70
	aero 1
	elas 10

*in the norn meso, near the heat pad
	mvsf 463 9288

	seta va01 targ

* Link the teleporters together:
	targ va00
	seta ov00 va01

	targ va01
	seta ov00 va00



* FIREPLACE INSTALL SCRIPT   

	inst
* Genus Invisible, Plane 1 (the plane behind the logs)
	new: simp 1 1 64700 "fplc" 0 0 1
	mvto 395 99565
	anim [0 0 0 1 1 1 0 0 0 2 2 2 0 0 0 1 1 1 255]
*three of every frame to slow it down a bit.
	sndl "stov"
*by default, the fireplace emits Heat at a strength of 0.6 (apparently this is about the upper range of what the True Warm Blood genome can thrive in)
	emit 2 0.6

*store the fireplace in a variable to be targeted by the window later (in WINDOW ACTIVATE 1)
	seta va66 targ



* SNOWY WINDOW INSTALL SCRIPT

	inst
* Genus Invisible, Plane 1
	new: simp 1 1 64701 "swdw" 0 0 1
	attr 4
	clac 0
	mvto 80 99271

*init ov00 as an agent and store the window we created earlier in it.
	seta ov00 null
	seta ov00 va66



* FIREPLACE LOGS INSTALL SCRIPT   

	inst
* Genus Invisible, Plane 2 (the plane in front of the animated part)
	new: simp 1 1 64700 "fplc" 0 3 2
	mvto 453 99766
*919 99738
*emit norn home smell (same strength as incubator pad in Norn Meso)
	emit 15 .25

*end of install scripts block! none of the above code will execute if the room was detected as already installed.
else
	targ pntr
	snde "no__"
endi



* RED PRESENT (STACKABLE BLOCKS) ACTIVATE 1 SCRIPT

scrp 2 21 64704 1

	lock

*magical sparkle sound
	snde "pkup"

	setv va00 posl
	setv va01 post
	addv va01 13

	inst

	setv va88 0
*	setv va51 99364
	reps 10
		new: simp 2 21 64711 "blks" 12 0 5000

*Activate 1 + Activate 2 + Hit + Pick Up
		bhvr 43

		mvsf va00 va01
* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
		attr 199

*		clac 0

		perm 60
		elas 10
		aero 5
		fric 100
		accg 4

		seta ov01 null
*		setv ov61 100
*		base 0
*		anim [0]
		tick 1

*apply random velocity so the blocks aren't all inside each other!
		velo rand -40 40 rand 0 40

*maybe?
*velo 0 0

*apply a random initial colour to each block and store it in ov00.
		setv ov00 rand 0 2

*set the block to the correct frame.
		anim []
		base ov00
		anim [0]

	repe

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ
	unlk
endm

* RED PRESENT ACTIVATE 2 SCRIPT

scrp 2 21 64704 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* RED PRESENT HIT SCRIPT

scrp 2 21 64704 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* RED PRESENT COLLISION SCRIPT

scrp 2 21 64704 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm

* STACKABLE BLOCKS ACTIVATE 1 SCRIPT

scrp 2 21 64711 1

*Stimulate the creature with "Played with toy"
	stim writ from 97 1

	doif from <> pntr or carr <> null

*make a sound
		snde "cpop"
*ov00 stores which colour the block is.
		doif ov00 = 0
			setv ov00 1
		elif ov00 = 1
			setv ov00 2
		else
*elif ov00 = 2
			setv ov00 0
		endi
*set the block to the correct frame.
		anim []
		base ov00
		anim [0]

	else
*(call hit script)
		mesg writ ownr 3
	endi

endm

* STACKABLE BLOCKS ACTIVATE 2 SCRIPT

scrp 2 21 64711 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* STACKABLE BLOCKS HIT SCRIPT

scrp 2 21 64711 3

*	seta ov01 null


*	setv va76 posx
*	subv va76 200
*
*	mvsf va76 posy

*	mesg writ ownr 4







	accg 4
	setv vely -10
	setv va00 rand -10 10
	setv velx va00
*
	etch 2 21 64711
		accg 4
		setv vely -10
		addv va00 3
		setv velx va00

*pick up script - check for collisions
		tick 0
		seta va04 targ
		inst
		enum 2 21 64711
			doif ov01 = va04 and targ <> ownr
				setv ov76 1
				tick 1
*				tick 15
			endi
		next
		slow

	next

*
*		mesg writ ownr 4
*		mesg writ ownr 5
*
*		etch 2 21 64711
*			accg 4
*			setv vely -10
*			addv va00 3
**setv velx va00
*
*			mesg writ ownr 4
*			mesg writ ownr 5
*
*		next
*	next


*enum 2 21 64711

*accg 4
*setv vely -10
*(call pickup script)
*		mesg writ ownr 4

*(call drop script)
*		mesg writ ownr 5

*	mesg writ ownr 9
*
*next

endm


* STACKABLE BLOCKS DROP SCRIPT

scrp 2 21 64711 5
*enumurate through every block the block is touching
	etch 2 21 64711
*add 1 to va00

		addv va00 1
	next
*if the block isn't touching anything, set the timer to go off on the next frame.
	doif va00 <= 1
		tick 1
	endi
*set accel due to gravity to 4.
	accg 4
endm

* STACKABLE BLOCKS PICKUP SCRIPT

scrp 2 21 64711 4

*target the picked up block and disable the timer or something?
*	targ ownr
	tick 0
	seta va04 targ
	inst
	enum 2 21 64711
		doif ov01 = va04 and targ <> ownr
			tick 1
		endi
	next
	slow

endm

* STACKABLE BLOCKS TIMER SCRIPT - CALLED IF THE BLOCK IS TOUCHING ANOTHER OBJECT WHEN DROPPED
* (copy pasted from Creatures 3's "lightmodule.cos" with slight changes)

scrp 2 21 64711 9

*temporarily disable this script when tick is set to 15
*	doif tick = 15
*		tick 0
*	else

	doif ov01 <> null
		targ ov01
		setv va50 posx
		setv va51 posy
		targ ownr

	endi

	inst
	seta va03 null
	seta va88 null
	etch 2 21 64711
	
	
		doif targ <> ownr and carr = null
			setv va01 rely ownr targ
			doif va01 > 0
				setv va00 1
				setv va02 post
				seta va88 targ
			endi
		endi
	next
	seta ov01 va88

	doif va00 = 0
		seta ov01 null
	endi

	doif va00 = 1
*new check to see if you're a block that has just been kicked.
		doif ov76 = 0
			gsub stak
		else
			setv ov76 0
			gsub fall
		endi
	endi

	doif obst 3 gt 0
		gsub fall
	endi
	doif obst 3 = 0
		tick 0
	endi

	subr stak
		accg 0
		subv va02 30
		velo 0 0
		doif tmvt posl va02 <> 1
			mvsf posl va02
		else
			mvto posl va02
		endi
		tick 0
*make a sound if you successfully stacked (but not if you're being held)
		doif carr = null
			sndc "drp6"
		endi
		stop
	retn

	subr fall
		inst
		seta va04 targ
		enum 2 21 64711
			doif ov01 = va04
				tick 1
			endi
		next
		accg 4
		stop
	retn
	slow

*end of tick 15 disable endif.
*	endi
endm

* STACKABLE BLOCKS COLLISION SCRIPT

scrp 2 21 64711 6
	sndc "drp6"
endm



* BLUE PRESENT (DALEK) ACTIVATE 1 SCRIPT

scrp 2 21 64708 1

	lock

*magical sparkle sound
	snde "pkup"

	setv va00 posl
	setv va01 post
	addv va01 13

	inst

	new: simp 2 21 64703 "dalk" 0 0 5000
* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

	clac 0

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	accg 3
	elas 0
	fric 100
	aero 1
	perm 60

	mvsf va00 va01

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ
endm

* BLUE PRESENT ACTIVATE 2 SCRIPT

scrp 2 21 64708 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* BLUE PRESENT HIT SCRIPT

scrp 2 21 64708 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* BLUE PRESENT COLLISION SCRIPT

scrp 2 21 64708 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



* DALEK ACTIVATE 1 SCRIPT

scrp 2 21 64703 1
	lock
	sndc "xmnt"
	clac 1
	stim writ from 97 1
	anim [0 0 1  1 1 0 0 0 1 1 0 1 0 0 0 1 1 1 1 1 0 1 1 1 0]
	over
	unlk
endm

* DALEK ACTIVATE 2 SCRIPT

scrp 2 21 64703 2
	lock

	inst
	stim writ from 97 1
	setv vely -5

*count up to 3, and when you reach it, change direction
	addv ov01 1

	doif ov01 = 3
		setv ov01 0
		doif mira = 1
			mira 0
		else
			mira 1
		endi
	endi

*move in whichever direction you're facing
	doif mira = 1
		setv velx 30
	else
		setv velx -30
	endi


	sndc "ct_1"
	clac 0
	wait 15
	unlk

endm

* DALEK HIT SCRIPT

scrp 2 21 64703 3
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5
endm

* DALEK COLLISION SCRIPT

scrp 2 21 64703 6
	sndc "drp6"
endm



* PURPLE PRESENT (FURBY) ACTIVATE 1 SCRIPT

scrp 2 21 64705 1

	lock

*magical sparkle sound
	snde "pkup"

	setv va00 posl
	setv va01 post
	addv va01 13

	inst

	new: simp 2 21 64702 "furb" 0 0 5000
* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199


	clac 0

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	accg 3
	elas 0
	fric 100
	aero 1
	perm 60

	mvsf va00 va01

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ
endm

* PURPLE PRESENT ACTIVATE 2 SCRIPT

scrp 2 21 64705 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* PURPLE PRESENT HIT SCRIPT

scrp 2 21 64705 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* PURPLE PRESENT COLLISION SCRIPT

scrp 2 21 64705 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



* FURBY ACTIVATE 1 SCRIPT

scrp 2 21 64702 1
	lock
	clac 1
	stim writ from 97 1

*reduce loneliness a bit
	targ from
	chem 156 -0.25
	targ ownr

	anim [0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 1 1 0]
* ah ha ha, snort
	sndc "frb2"
	wait 25
	unlk
endm

* FURBY ACTIVATE 2 SCRIPT

scrp 2 21 64702 2
	lock
	clac 0
	stim writ from 97 1

*reduce loneliness a bit
	targ from
	chem 156 -0.25
	targ ownr

	anim [0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 1 1 1 0]
* brrrr... pet, me...
	sndc "frb1"
	wait 60
	unlk
endm

* FURBY HIT SCRIPT

scrp 2 21 64702 3
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5
endm

* FURBY COLLISION SCRIPT

scrp 2 21 64702 6
	sndc "dr10"
*tick 0
endm

* FURBY DROP SCRIPT

scrp 2 21 64702 5
	tick 5
endm

* FURBY TIMER SCRIPT (called just after dropping)

scrp 2 21 64702 9

*if the velocity is particularly high
	doif velx > 10 or velx < -10 or vely > 10 or vely < -10
*furby says whee!!
		stpc
		snde "frb3"
*		sndc "frb3"
		anim [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0]
		tick 0
	endi

	doif velx = 0 and vely = 0
		tick 0
	endi


endm



* PINK PRESENT (RC CAR) ACTIVATE 1 SCRIPT

scrp 2 21 64712 1

*magical sparkle sound
	snde "pkup"

	lock

	setv va00 posl
	setv va01 post
	addv va01 13

	inst

****CAR*****

	new: simp 2 21 64709 "scar" 0 0 5000

* Carryable + Mouseable + Suffer Collisions + Suffer Physics (not activatable by hand!)
	attr 195

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	accg 3
	elas 0
	fric 100
	aero 1
	perm 60

*temporarily store the object in a variable to link to the remote later
	seta va99 targ

	mvsf va00 va01

****REMOTE*****

	new: comp 2 21 64710 "scar" 0 1 5000
	pat: butt 1 "scar" 3 2 0 0 0 [] 1 1
*	pat: butt 2 "scar" 4 2 122 0 0 [] 2 1002

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

	clac 0

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	accg 3
	elas 0
	fric 100
	aero 1
	perm 60

*has to be init'd as null or problems arise when checking for a valid linked car agent
	seta ov00 null
	seta ov00 va99

	mvsf va00 va01

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ

endm

* PINK PRESENT ACTIVATE 2 SCRIPT

scrp 2 21 64712 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* PINK PRESENT HIT SCRIPT

scrp 2 21 64712 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* PINK PRESENT COLLISION SCRIPT

scrp 2 21 64712 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



**************
*****CAR******
**************


* RC CAR (CAR) ACTIVATE 1 SCRIPT

scrp 2 21 64709 1
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5
endm

* RC CAR (CAR) ACTIVATE 2 SCRIPT

scrp 2 21 64709 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* RC CAR (CAR) HIT SCRIPT

scrp 2 21 64709 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* RC CAR (CAR) COLLISION SCRIPT

scrp 2 21 64709 6
*ov01 is set to 0 a few ticks after moving
	doif ov01 = 0
		sndc "drp6"
	endi
endm


**************
****REMOTE****
**************



* RC CAR (REMOTE) ACTIVATE 1 (RIGHT)

scrp 2 21 64710 1

*animate button press
	anim [1 1 1 0]

	lock

	stim writ from 97 1

*if the car agent can't be targeted for whatever reason, make an unhelpful sound
	doif ov00 = null
		snde "no__"
	else
*target the car linked to this remote
		targ ov00

*otherwise move the car!

		lock
*object variable used to tell it to NOT make a sound while colliding
		setv ov01 1
		mira 0
		sndc "scar"
		setv vely -6
		setv velx 37
		wait 1
		unlk

*we're probably done moving, re-enable collision sounds
		wait 6
		setv ov01 0
	endi
endm

* RC CAR REMOTE ACTIVATE 2 (LEFT)

scrp 2 21 64710 2

*fix for pointer not animating
	targ pntr
	anim [1 0]
	targ ownr

*animate button press
	part 1
	anim [1 1 1 0]
	part 0

	lock

	stim writ from 97 1

*if the car agent can't be targeted for whatever reason, make an unhelpful sound
	doif ov00 = null
		snde "no__"
	else
*target the car linked to this remote
		targ ov00

*otherwise move the car!

		lock
*object variable used to tell it to NOT make a sound while colliding
		setv ov01 1
		mira 1
		sndc "scar"
		setv vely -6
		setv velx -37
		wait 1
		unlk

*we're probably done moving, re-enable collision sounds
		wait 6
		setv ov01 0
	endi
endm

* RC CAR (REMOTE) HIT SCRIPT

scrp 2 21 64710 3
*apply velocity, let the creature know they played with a toy
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5

*(randoms between activate 1 and activate 2)
	mesg writ ownr rand 0 1
endm

* RC CAR (REMOTE) COLLISION SCRIPT

scrp 2 21 64710 6
	sndc "drp6"
endm



*SANTA HAT DROP SCRIPT

scrp 1 1 64706 5

	snde "clot"
	etch 4 0 0

*Special case for Gaia (ov37 is set to 5 when Gaia is created!)
		doif gnus = 4 and spcs = 2 and ov37 = 5

			targ norn
			sezz "aaa"
*and make a random sound
			doif rand 0 1 eq 1
				snde "ctho"
			else
				snde "cth2"
			endi

*Wear clothing 6 (santa hat + xmas tree head) on body part 0 (head), priority 5 (might cause hair to draw under hat? if so change 5 to 0 again)
			wear 0 6 5
*Wear clothing 4 (xmas tree body) on body part 1 (body), priority 5
			wear 1 4 5
*Any geat other than Gaia should just make an error sound
		elif gnus = 4
			snde "excl"
*any other type of creature
		else
*Wear clothing 6 (santa hat) on body part 0 (head), priority 5
			wear 0 6 5

*and make a random sound
			doif rand 0 1 eq 1
				snde "ctho"
			else
				snde "cth2"
			endi

		endi

	next

*move coat hanger back to default position
	targ ownr
	mvto 617 99501
endm



* COAT HANGER PICKUP SCRIPT

scrp 1 1 64713 4
	anim [0 1 2 3]
endm

*COAT HANGER DROP SCRIPT

scrp 1 1 64713 5
	inst

*make click detection more accurate for clicking on norns
	tran 1 0
	etch 4 0 0
		nude
	next

*move coat hanger back to default position and animate
	targ ownr

*make click detection bounding box based again
	tran 0 0
	mvto 507 99491
	anim [3 2 1 0]
endm



* MINCE PIE VENDOR ACTIVATE 1 SCRIPT

scrp 2 23 64722 1

	lock

*Send a signal from the specified output port to all connected inputs. 
	prt: send 0 _p1_

	sndc "mvnd"
	anim [0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 17 16 15 16 17 18 17 16 15 19 20 21 22 23]
	over

	setv va00 posl
	addv va00 65
	setv va01 post
	addv va01 72

	inst
	pose 0
	new: simp 2 11 64723 "minc" 0 0 401

	attr 195

	bhvr 48

	elas 30
	fric 100
	accg 5
	aero 1
	perm 60

*smells like fatty food
	emit 8 .5
	mvsf va00 va01

*apply random velocity
	setv velx rand -5 5
	setv vely -10

	targ ownr

	wait 10

*let the creature know they activated a machine
	stim writ from 92 1

	unlk

endm

* MINCE PIE VENDOR ACTIVATE 2 SCRIPT

scrp 2 23 64722 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* MINCE PIE VENDOR INPUT PORT SCRIPT

scrp 2 23 64722 1000
*if the signal strength wasn't 0
	doif _p1_ <> 0
*run the activate 1 script, but pass the Parameter the Input object sent on.
		mesg wrt+ ownr 0 _p1_ 0 0
	endi
endm

* MINCE PIE VENDOR HIT SCRIPT

scrp 2 23 64722 3
	sndc "hit_"
	velo 0 rand -10 -20
*chance of disconnecting ports when a creature hits it
	prt: bang rand 40 80
	stim writ from 92 1
endm

* MINCE PIE EAT SCRIPT

scrp 2 11 64723 12
	lock
	sndc "chwp"
*ate food
	stim writ from 79 1

	targ from
*inject them with a little bit of alcohol
	chem 75 .25
*and a little bit of comfort
	chem 162 .25
	targ ownr

	wait 20
	kill ownr
	unlk
endm

* MINCE PIE COLLISION SCRIPT

scrp 2 11 64723 6
	sndc "dr10"
endm




* SNOWY WINDOW ACTIVATE 1 SCRIPT

scrp 1 1 64701 1

	lock
	sndc "crek"
	doif pose < 5
		anim [0 1 2 3 4 5 6]

*if the fireplace agent can't be targeted for whatever reason, make an unhelpful sound (sound disabled)
		doif ov00 = null
*			snde "no__"
		else
*target the fireplace
			targ ov00

*turn the fireplace Heat down to 0.2
			emit 2 0.2
		endi
		targ ownr
	else
		anim [6 5 4 3 2 1 0]

*if the fireplace agent can't be targeted for whatever reason, make an unhelpful sound (sound disabled)
		doif ov00 = null
*			snde "no__"
		else
*target the fireplace
			targ ov00

*turn the fireplace Heat back to the default, 0.6
			emit 2 0.2
		endi
		targ ownr
	endi
	over
	wait 1

	unlk


endm




* XMAS TELEPORTERS ACTIVATE 1 SCRIPT

scrp 3 2 64720 1

*copy the code the remote uses to check if one of the teleporters has been deleted when activating.


*make sure ov00 still exists BEFORE you do anything.
*if the user deletes either end of the teleporter MID-teleport that's on them.
	doif ov00 = null
		snde "no__"
	else


*the teleporter must not be moving before it can be activated.
		doif velx = 0 and vely = 0

			inst

*		setv ov02 1
*-2 hand can't pick up! *-4 hand can't activate
			attr 193
*norns can't do anything to it!
			bhvr 0
			targ ov00
*		setv ov02 1
*-2 hand can't pick up! *-4 hand can't activate
			attr 193
*norns can't do anything to it!
			bhvr 0
			targ ownr

			inst

			sndc "xmst"

			part 1
			anim [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 32 33 34 35 36 36 36 36 36 36 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0]
			part 0

			targ ov00

*	lock

			wait 2

			sndc "xmst"

			part 1
			anim [1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 32 33 34 35 36 36 36 36 36]
			over
			part 0


			targ ownr

			lock

*mostly pre-made teleporter script from some ancient tutorial
			inst
			doif carr eq null
				targ ov00
				setv va00 posx
				setv va01 posy
				setv va02 va00
				setv va03 posb
				subv va03 10
				targ ownr
				doif from eq pntr
					scam null 0
					cmrp va00 va01 0
					targ ownr
					etch 4 0 0
						seta va05 targ
						doif carr ne null
							targ carr
							drop
						endi
						targ va05
						mvft va02 va03
						stim writ from 95 1
					next
				else
					targ from
					doif carr ne null
						targ carr
						drop
					endi
					doif crea from eq 1
						mvft va02 va03
						stim writ from 95 1
					else
						doif tmvt va00 va01 eq 1
							mvsf va00 va01
						endi
					endi
				endi
			endi

			slow
			targ ownr

			targ ov00

			lock

			part 1
			anim [36 37 36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0]
			over
			part 0

			unlk


*+2 hand can pick up! *+4 hand can activate
			attr 199
*norns can act1 or 2 it!
			bhvr 3
			targ ov00
*		setv ov02 1
*+2 hand can pick up! *+4 hand can activate
			attr 199
*norns can act1 or 2 it!
			bhvr 3
			targ ownr

		endi

*end of "does ov00 exist" endif
	endi

endm

* XMAS TELEPORTERS ACTIVATE 2 SCRIPT

scrp 3 2 64720 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm



* TURKEY-O-MATIC VENDOR ACTIVATE 1 SCRIPT

scrp 2 23 64724 1

	lock

*Send a signal from the specified output port to all connected inputs. 
	prt: send 0 _p1_

	sndc "vend"
	anim [0 1 1 2 2]
	over

	setv va00 posl
	addv va00 30
	setv va01 post
	addv va01 70

	inst

	new: simp 2 11 64725 "turk" 0 0 401

	attr 195

*Eat + Pick Up
	bhvr 48

	elas 30
	fric 50
	accg 3
	aero 1
	perm 60

*smells like fatty food
	emit 8 .75
	mvsf va00 va01

*apply random velocity
	setv velx rand -5 5
	setv vely -10

	targ ownr
	lock
	anim [3 3 3 3 3 4 4 5 5 0]

	wait 10

*let the creature know they activated a machine
	stim writ from 92 1

	unlk

endm

* TURKEY-O-MATIC VENDOR ACTIVATE 2 SCRIPT

scrp 2 23 64724 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* TURKEY-O-MATIC VENDOR INPUT PORT SCRIPT

scrp 2 23 64724 1000
*if the signal strength wasn't 0
	doif _p1_ <> 0
*run the activate 1 script, but pass the Parameter the Input object sent on.
		mesg wrt+ ownr 0 _p1_ 0 0
	endi
endm

* TURKEY-O-MATIC VENDOR HIT SCRIPT

scrp 2 23 64724 3
	sndc "hit_"
	velo 0 rand -10 -20
*chance of disconnecting ports when a creature hits it
	prt: bang rand 40 80
	stim writ from 92 1
endm

* TURKEY EAT SCRIPT

scrp 2 11 64725 12
	lock
	sndc "chwp"
	stim writ from 79 1

	targ from
*inject them with some protein. it's turkey after all
	chem 12 .25
*and a little bit of comfort
	chem 162 .25
	targ ownr

	wait 5

	doif pose = 0
		pose 1
	elif pose = 1
		pose 2
	elif pose = 2
		pose 3
	elif pose = 3
		pose 4
	elif pose = 4
		pose 5
		over
		wait 40
		alph 50 1
		wait 1
		alph 100 1
		wait 1
		alph 150 1
		wait 1
		alph 200 1
		wait 1
		alph 250 1
		wait 1
		kill ownr
	endi

	unlk
endm

* TURKEY COLLISION SCRIPT

scrp 2 11 64725 6
	sndc "dr10"
endm



* PUDDING VENDOR ACTIVATE 1 SCRIPT

scrp 2 23 64726 1

	lock

*Send a signal from the specified output port to all connected inputs. 
	prt: send 0 _p1_

	sndc "vend"
	anim [0 1 2 3 4 5 6 7 8]
	over

	setv va00 posl
	addv va00 139
	setv va01 post
	addv va01 31

	inst

	new: simp 2 11 64727 "pudd" 0 0 401

	attr 195

*Eat + Pick Up
	bhvr 48

	elas 30
	fric 50
	accg 3
	aero 1
	perm 60

*smells like fatty food
	emit 8 .75
	mvsf va00 va01

*apply random velocity
	setv velx rand 5 15
	setv vely -5

	targ ownr
	anim [9 10 11]
	over

*let the creature know they activated a machine
	stim writ from 92 1

	unlk

endm

* PUDDING VENDOR ACTIVATE 2 SCRIPT

scrp 2 23 64726 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm


* PUDDING VENDOR INPUT PORT SCRIPT

scrp 2 23 64726 1000
*if the signal strength wasn't 0
	doif _p1_ <> 0
*run the activate 1 script, but pass the Parameter the Input object sent on.
		mesg wrt+ ownr 0 _p1_ 0 0
	endi
endm

* PUDDING VENDOR HIT SCRIPT

scrp 2 23 64726 3
	sndc "hit_"
	velo 0 rand -10 -20
*chance of disconnecting ports when a creature hits it
	prt: bang rand 40 80
	stim writ from 92 1
endm

* PUDDING EAT SCRIPT

scrp 2 11 64727 12

	lock
	sndc "chwp"
*ate food
	stim writ from 79 1

	targ from
*inject them with a little bit of alcohol
	chem 75 .25
*and a little bit of comfort
	chem 162 .25
	targ ownr

	wait 5

	doif pose = 0
		pose 1
	elif pose = 1
		pose 2
	elif pose = 2
		pose 3
	elif pose = 3
		kill ownr
	endi

	unlk
endm

* PUDDING COLLISION SCRIPT

scrp 2 11 64727 6
	sndc "dr10"
endm



* RED STOCKING (HAPPY BALL) ACTIVATE 1 SCRIPT

scrp 2 21 64714 1
	lock

	setv va00 posl
	addv va00 15
	setv va01 post
	addv va01 25

	new: simp 2 21 64719 "sbal" 17 0 5000
* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199
	bhvr 35

*its small so it uses the sprite bounds instead of pixel perfect
	tran 0 0

	aero 10
	perm 60
	accg 2
	elas 90
	fric 90

*make sure it's a valid position before you try and move it there (autokill proof + stops it appearing above the shelf)
	doif tmvt va00 va01 = 1
		mvto va00 va01
	else
		mvsf va00 va01
	endi

*	setv ov61 10

	targ ownr

	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ

	unlk
endm

* RED STOCKING PICKUP SCRIPT

scrp 2 21 64714 4

*stocking becomes physical once picked up
	attr 199

endm

* RED STOCKING ACTIVATE 2 SCRIPT

scrp 2 21 64714 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* RED STOCKING HIT SCRIPT

scrp 2 21 64714 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* RED STOCKING COLLISION SCRIPT

scrp 2 21 64714 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



* HAPPY BALL ACTIVATE 1 SCRIPT

scrp 2 21 64719 1
	inst
	stim writ from 97 1

	setv va00 posl
	setv va01 posr
	addv va00 va01
	divv va00 2
	targ from
	setv va01 posl
	targ ownr
	doif va01 lt va00
		setv va02 rand 15 25
	else
		setv va02 rand -25 -15
	endi
	velo va02 rand -70 -20

endm

* HAPPY BALL ACTIVATE 2 SCRIPT

scrp 2 21 64719 2
	inst
	stim writ from 97 1

	setv va00 posl
	setv va01 posr
	addv va00 va01
	divv va00 2
	targ from
	setv va01 posl
	targ ownr
	doif va01 lt va00
		setv va02 rand 15 25
	else
		setv va02 rand -25 -15
	endi
	velo va02 rand 20 70
endm

* HAPPY BALL HIT SCRIPT

scrp 2 21 64719 3
*(randoms between activate 1 and activate 2)
	mesg writ ownr rand 0 1
endm

* HAPPY BALL COLLISION SCRIPT

scrp 2 21 64719 6
	inst

*Urge all creatures who can see OWNR to perform an action on OWNR.
	urge sign 0.5 -1 0.0

	setv va00 vely
	doif va00 lt 0
		negv va00
	endi
	doif va00 gt 1
		snde "bing"
*		snde "boi2"
	endi

	setv va00 _p1_
	setv va01 _p2_
	doif va00 lt 0
		negv va00
	endi
	doif va01 lt 0
		negv va01
	endi
	doif va00 lt 3 and va01 lt 3
	endi
endm



* GREEN STOCKING (MINI SPINNING TOP) ACTIVATE 1 SCRIPT

scrp 2 21 64715 1
	lock

	setv va00 posl
	addv va00 6
	setv va01 post
	addv va01 15

	inst
	new: simp 2 21 64717 "mini" 13 0 600

	puhl -1 11 6

* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199
* Use the bounding box for click detection because it's tiny
	tran 0 0

	clac 0

	aero 1
	perm 60
	accg 2
	elas 0
	fric 90

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	pose 12

*make sure it's a valid position before you try and move it there (autokill proof + stops it appearing above the shelf)
	doif tmvt va00 va01 = 1
		mvto va00 va01
	else
		mvsf va00 va01
	endi

	accg 3

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ

	unlk
endm

* GREEN STOCKING PICKUP SCRIPT

scrp 2 21 64715 4

*stocking becomes physical once picked up
	attr 199

endm

* GREEN STOCKING ACTIVATE 2 SCRIPT

scrp 2 21 64715 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* GREEN STOCKING HIT SCRIPT

scrp 2 21 64715 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* GREEN STOCKING COLLISION SCRIPT

scrp 2 21 64715 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



* MINI SPINNING TOP ACTIVATE 1 SCRIPT
* (based on the one from Creatures Adventures but with some bug fixing so it can be picked up and dropped mid anim without crashing)

scrp 2 21 64717 1

	lock

*this variable is used to track if the spinning top was picked up while spinning.
*pretty sure it sets itself to 0 whenever this script starts but just incase...
	setv va99 0

	setv ov00 0

*temporarily make it unactivatable
	clac -1
	sndc "mtop"
	anim [1 2 3 4 5 6 7 8 9 255]
	setv va00 rand 35 50

	reps 20

		doif va99 = 0
			setv va01 rand -10 10

*don't try and push yourself up if you're already moving up or down rapidly!
*doif vely < 5 and vely > -5
*setv vely -3
*endi

*		addv instead of setv prevents it from floating!
			addv vely -3

			setv velx va01

			wait 1

			doif carr = pntr
*reset pose, stop the sound, make it activatable again
				pose 0
*				stpc
				fade
				clac 0
*let the script know it doesnt have to do the rest of the stuff
				setv va99 1
			endi
		endi

	repe


*having lock here means that picking it up overrides the anim most of the time, but doesn't break the end of the spin anim (removing lock entirely DOES break it)
*lock


	reps 8
		doif va99 = 0
			addv va02 1
			pose va02

			doif va02 eq 9

				setv va02 0

			endi

			setv va01 rand -5 5
			setv velx va01
			wait 1

			doif carr = pntr
*reset pose, stop the sound, make it activatable again
				pose 0
*			stpc
				fade
				clac 0
*let the script know it doesnt have to do the rest of the stuff
				setv va99 1
			endi
		endi
	repe

	doif carr = null

		anim [10 11 12]
		over
*	stpc
		fade
		setv velx 0
		inst
		setv vely -3
*make it activatable again
		clac 0
		slow
	endi

*reset the variable so it knows the movement wasn't cancelled by being picked up
	setv va99 0
	unlk
endm

* MINI SPINNING TOP ACTIVATE 2 SCRIPT

scrp 2 21 64717 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* MINI SPINNING TOP HIT SCRIPT

scrp 2 21 64717 3
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5
endm

* MINI SPINNING TOP PICK UP SCRIPT

scrp 2 21 64717 4

*reset pose, stop the sound, make it activatable again
	pose 0
*	stpc
	fade
	clac 0

endm

* MINI SPINNING TOP DROP SCRIPT

scrp 2 21 64717 5
	setv ov00 1
*make it activatable again
	clac 0

endm

* MINI SPINNING TOP COLLISION SCRIPT

scrp 2 21 64717 6
	doif velx = 0 and vely = 0 and ov00 = 1
*		base 0
		sndc "drp6"
*		pose 12
		anim [10 11 12]
		setv ov00 0
*make it activatable again
		clac 0
	endi



endm



*BLUE STOCKING (SNOW GLOBE) ACTIVATE 1 SCRIPT

scrp 2 21 64716 1
	lock

	setv va00 posl
	addv va00 10
	setv va01 post
	addv va01 20
	inst

	new: simp 2 21 64718 "snog" 0 0 5000
* Carryable + Mouseable + Activateable + Suffer Collisions + Suffer Physics
	attr 199

	tran 0 0

*clac 0

*Activate 1 + Activate 2 + Hit + Pick Up
	bhvr 43

	accg 3
	elas 0
	fric 100
	aero 1
	perm 60


*make sure it's a valid position before you try and move it there (autokill proof + stops it appearing above the shelf)
	doif tmvt va00 va01 = 1
		mvto va00 va01
	else
		mvsf va00 va01
	endi

	targ ownr
	alph 50 1
	wait 1
	alph 100 1
	wait 1
	alph 150 1
	wait 1
	alph 200 1
	wait 1
	alph 250 1
	wait 1
	kill targ

	unlk
endm

* BLUE STOCKING PICKUP SCRIPT

scrp 2 21 64716 4

*stocking becomes physical once picked up
	attr 199

endm

* BLUE STOCKING ACTIVATE 2 SCRIPT

scrp 2 21 64716 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* BLUE STOCKING HIT SCRIPT

scrp 2 21 64716 3
*(hit is the same as activate 1)
	mesg writ ownr 0
endm

* BLUE STOCKING COLLISION SCRIPT

scrp 2 21 64716 6

*Urge all creatures who can see OWNR to perform an action on OWNR.
*so they get encouraged to open the gift if it gets put down next to them!
	urge sign 0.5 -1 0.0

endm



* SNOW GLOBE ACTIVATE 1 SCRIPT

scrp 2 21 64718 1
	lock
	stim writ from 97 1
	anim [0 0 0 0 0 0 1 2 3 4 5 6 7 8 7 6 7 8 7 6 7 8 9 10 11 12 13 0]
	over
	wait 5
	unlk
endm

* SNOW GLOBE ACTIVATE 2 SCRIPT

scrp 2 21 64718 2
*(activate 2 is the same as activate 1)
	mesg writ ownr 0
endm

* SNOW GLOBE HIT SCRIPT

scrp 2 21 64718 3
	stim writ from 97 1
	setv vely -7
	setv velx rand -5 5
endm

* SNOW GLOBE COLLISION SCRIPT

scrp 2 21 64718 6
	sndc "drp6"
endm